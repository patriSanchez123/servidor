<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>1.2.- Incorporación de métodos de autentificación a una aplicación web. | Tema 3 </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="NONAME" />
<meta name="generator" content="eXeLearning 2.4.2 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" /></head>
<body class="exe-web-site" id="exe-node-4"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">Tema 3</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Desarrollo de aplicaciones web con PHP.</a></li>
   <li class="current-page-parent"><a href="1_autentificacin_de_usuarios_y_control_de_acceso.html" class="current-page-parent daddy">1.- Autentificación de usuarios y control de acceso.</a>
   <ul>
      <li><a href="11_mecanismos_de_autentificacin_i.html" class="daddy">1.1.- Mecanismos de autentificación (I).</a>
      <ul class="other-section">
         <li><a href="111_mecanismos_de_autentificacin_ii.html" class="no-ch">1.1.1.- Mecanismos de autentificación (II).</a></li>
      </ul>
      </li>
      <li id="active"><a href="12_incorporacin_de_mtodos_de_autentificacin_a_una_aplicacin_web.html" class="active no-ch">1.2.- Incorporación de métodos de autentificación a una aplicación web.</a></li>
   </ul>
   </li>
   <li><a href="2_cookies.html" class="no-ch">2.- Cookies.</a></li>
   <li><a href="3_manejo_de_sesiones.html" class="daddy">3.- Manejo de sesiones.</a>
   <ul class="other-section">
      <li><a href="31_configuracin.html" class="no-ch">3.1.- Configuración.</a></li>
      <li><a href="32_inicio_y_fin_de_una_sesin.html" class="no-ch">3.2.- Inicio y fin de una sesión.</a></li>
      <li><a href="33_gestin_de_la_informacin_de_la_sesin_i.html" class="daddy">3.3.- Gestión de la información de la sesión (I).</a>
      <ul class="other-section">
         <li><a href="331_gestin_de_la_informacin_de_la_sesin_ii.html" class="no-ch">3.3.1.- Gestión de la información de la sesión (II).</a></li>
         <li><a href="332_gestin_de_la_informacin_de_la_sesin_iii.html" class="no-ch">3.3.2.- Gestión de la información de la sesión (III).</a></li>
         <li><a href="333_gestin_de_la_informacin_de_la_sesin_iv.html" class="no-ch">3.3.3.- Gestión de la información de la sesión (IV).</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="4_herramientas_para_depuracin_de_cdigo.html" class="daddy">4.- Herramientas para depuración de código.</a>
   <ul class="other-section">
      <li><a href="41_instalacin_de_herramientas_de_depuracin.html" class="no-ch">4.1.- Instalación de herramientas de depuración.</a></li>
      <li><a href="42_depuracin_de_cdigo_en_php.html" class="no-ch">4.2.- Depuración de código en PHP.</a></li>
   </ul>
   </li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="111_mecanismos_de_autentificacin_ii.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="2_cookies.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">1.2.- Incorporación de métodos de autentificación a una aplicación web.</h1></header>
<article class="iDevice_wrapper FreeTextfpdIdevice" id="id13">
<div class="iDevice emphasis0">
<div id="ta13_73" class="block iDevice_content">
<div class="elemento_derecha">
<div class="elemento_centrado"><img src="DWES03_CONT_R03_Advertencia.png" alt="Símbolo de un ratón con el ojo de una cerradura." title="Ratón cerradura." height="192" width="72" /></div>
<div class="elemento_centrado credenciales"><a class="cc0" title="Dominio público" href="http://creativecommons.org/publicdomain/zero/1.0/deed.es" target="_blank"><span class="transparente">Dominio público</span></a> <a title="Spayder26." href="http://www.openclipart.org/detail/126769." target="_blank">Spayder26.</a></div>
</div>
<p>Si utilizas la función <code>header</code> para forzar al navegador a solicitar credenciales HTTP, el usuario introducirá un nombre y una contraseña. Pero el servidor no verificará esta información; deberás ser tú quien provea un método para comprobar que las credenciales que ha introducido el usuario son correctas.</p>
<p> </p>
<p>El método más simple es incluir en el código <span lang="en">PHP</span> de tu página las sentencias necesarias para comparar los datos introducidos con otros datos fijos. Por ejemplo, para permitir el acceso a un usuario "dwes" con contraseña "abc123.", puedes hacer:</p>
<p> </p>
<p> </p>
<div class="codigo elemento_centrado" style="width: 48.9em;">
<div class="texto_izquierda">
<pre><code>&lt;?php</code>
</pre>
<pre><code>if ($_SERVER['PHP_AUTH_USER']!='dwes' || $_SERVER['PHP_AUTH_PW']!='abc123.') {</code>
</pre>
<pre><code>    header('WWW-Authenticate: Basic Realm="Contenido restringido"');</code>
</pre>
<pre><code>    header('HTTP/1.0 401 Unauthorized');</code>
</pre>
<pre><code>    echo "Usuario no reconocido!";</code>
</pre>
<pre><code>    exit;</code>
</pre>
<pre><code>}</code>
</pre>
<pre><code>?&gt;</code>
</pre>
</div>
</div>
<p>Recuerda que el código <span lang="en">PHP</span> no se envía al navegador, por lo que la información de autentificación que introduzcas en el código no será visible por el usuario. Sin embargo, esto hará tu código menos portable. Si necesitas modificar el nombre de usuario o la contraseña, tendrás que hacer modificaciones en el código. Además, no podrás permitir al usuario introducir su propia contraseña.</p>
<p>Una solución mejor es utilizar un almacenamiento externo para los nombres de usuario y sus contraseñas. Para esto podrías emplear un fichero de texto, o mejor aún, una base de datos. La información de autentificación podrá estar aislada en su propia base de datos, o compartir espacio de almacenamiento con los datos que utilice tu aplicación <span lang="en">web</span>.</p>
<p>Si quieres almacenar la información de los usuarios en la base de datos "dwes", tienes que crear una nueva tabla en su estructura. Para ello, revisa y ejecuta estas sentencias <acronym title="Structured Query Language. Lenguaje de Consulta Estructurado." lang="en">SQL</acronym>.</p>
<div class="enlace_centrado"><a class="paquete" title="Descargar las sentencias SQL para crear en la base de datos 'dwes' la tabla de usuarios, y el registro correspondiente al usuario 'dwes'.  [zip - 1.00 KB]" href="DWES04_CONT_R03b_Crear_tabla_usuarios.zip">Estas sentencias <span lang="en">SQL</span>.</a> <span class="tamano"> (1.00 kB) </span></div>
</div>
</div>
</article>
<article class="iDevice_wrapper DestacadofpdIdevice" id="id14">
<div class="iDevice emphasis0" >
<div class="iDevice_destacadofpd">
<div id="ta14_70" class="block iDevice_content">
<p>Aunque se podr&iacute;an almacenar las contrase&ntilde;as en texto plano, es mejor hacerlo en formato encriptado. En el ejemplo anterior, para el usuario "dwes" se almacena el&nbsp; <a class="glosario">Hash MD5<span><em>Hash MD5. </em>Una funci&oacute;n hash es un m&eacute;todo para generar un resumen de un texto o un documento, de tal forma que a partir del resumen obtenido no es posible recuperar el texto original, ni hallar otro texto a partir del cual se obtenga el mismo resumen. Se llama hash al resumen obtenido al aplicar una funci&oacute;n has</span></a>&nbsp; correspondiente a la contrase&ntilde;a "abc123.". En <span lang="en">PHP</span> puedes usar la funci&oacute;n <strong>md5</strong> para calcular el hash <acronym title="Message-Digest Algorithm 5. Algoritmo de Resumen del Mensaje 5." lang="en">MD5</acronym> de una cadena de texto.</p>
<p class="enlace_centrado"><a title="Acceder a la informaci&oacute;n sobre la funci&oacute;n md5 en el manual de PHP." href="http://es.php.net/manual/es/function.md5.php">Funci&oacute;n md5.</a></p>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper EjercicioresueltofpdIdevice em_iDevice" id="id15">
<div class="iDevice emphasis_ejercicioresueltofpd" >
<header class="iDevice_header" style="background-image:url(icon_ejercicioresueltofpd.png)"><h1 class="iDeviceTitle">Ejercicio resuelto</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<section id="ta15_67" class="block story iDevice_content">

</section>
<section id="taquesQuestion0b15" class="block iDevice_content">
Utiliza la extensión <code>MySQLi</code> para modificar el ejercicio anterior, de tal forma que las credenciales del usuario se comprueben con la información de la nueva tabla &quot;usuarios&quot; creada en la base de datos &quot;dwes&quot;. Si no existe el usuario, o la contraseña es incorrecta, vuelve a pedir las credenciales al usuario.

</section>
<form name="feedback-form-quesFeedback0b15" action="#" onsubmit="return false" class="feedback-form">
<div class="block iDevice_buttons feedback-button js-required">
<p><script type="text/javascript">var feedbackquesFeedback0b15text = "Mostrar retroalimentación";</script><input type="button" name="toggle-feedback-quesFeedback0b15" value="Mostrar retroalimentación" class="feedbackbutton feedback-toggler" /></p>
</div>
<section id="feedback-quesFeedback0b15" class="feedback js-feedback js-hidden">
<h1 class="js-sr-av">Retroalimentación</h1>
<p>
Revisa la solución propuesta. Fíjate que se debe usar la función md5 para comprobar la contraseña. Si introduces un usuario o contraseña incorrectos, el comportamiento depende del navegador que utilices; algunos te pedirán las credenciales de forma indefinida, y otros un número limitado de veces.
</p>
<div class="enlace_centrado">
<a class="pdf" href="DWES04_CONT_R03c_Solucion_ejercicio.pdf" title="Descargar la solución al ejercicio de utilización de una base de datos para comprobar las credenciales HTTP. [pdf - 8.00 KB]">Solución propuesta.</a> <span class="tamano"> (8.00 KB) </span> 
</div>
</section>
</form>
</div>
</div>
</div>
</article>
<article class="iDevice_wrapper EleccionmultiplefpdIdevice em_iDevice" id="id16">
<div class="iDevice emphasis_autoevaluacionfpd" >
<header class="iDevice_header" style="background-image:url(icon_autoevaluacionfpd.gif)"><h1 class="iDeviceTitle">Autoevaluación</h1></header>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<section class="question">
<form name="multi-choice-form-16_60" action="#" onsubmit="return false" class="activity-form">
<h1 class="js-sr-av">Pregunta</h1>
<div id="taquestion16_60" class="block question iDevice_content">
<strong>Las dos posibilidades que hemos visto para solicitar al usuario que se autentifique vía <span lang="en">HTTP</span> son la creación del fichero .htaccess, y la utilización de la función <code>header</code> de <span lang="en">PHP</span>. ¿Cuál de esas dos formas será preferible si quieres que los privilegios de acceso a tu aplicación varíen en función del día de la semana (por ejemplo, unos usuarios que puedan acceder de lunes a viernes y otros distintos el fin de semana)?</strong>

</div>
<section class="iDevice_answers">
<h1 class="js-sr-av">Respuestas</h1>
<section class="iDevice_answer">
<p class="iDevice_answer-field js-required">
<label for="i16_63" class="sr-av"><a href="#answer-16_63">Opción 1</a></label><input type="radio" name="option16_60" id="i16_63" class="exe-radio-option exe-radio-option-0-2-16_60-multi"/>
</p>
<div class="iDevice_answer-content" id="answer-16_63"><div id="taans16_63" class="block iDevice_content">
El fichero .htaccess.

</div>
</div>
</section>
<section class="iDevice_answer">
<p class="iDevice_answer-field js-required">
<label for="i16_89" class="sr-av"><a href="#answer-16_89">Opción 2</a></label><input type="radio" name="option16_60" id="i16_89" class="exe-radio-option exe-radio-option-1-2-16_60-multi"/>
</p>
<div class="iDevice_answer-content" id="answer-16_89"><div id="taans16_89" class="block iDevice_content">
La función <code>header</code>.

</div>
</div>
</section>
</section>
<section class="iDevice_feedbacks js-feedback">
<h1 class="js-sr-av">Retroalimentación</h1>
<section id="sa0b16_60" class="feedback js-hidden">
<div id="taf16_63" class=" iDevice_content">
Revisa la forma en que se definían los usuarios con acceso al utilizar el fichero .htaccess.

</div>
</section>
<section id="sa1b16_60" class="feedback js-hidden">
<div id="taf16_89" class=" iDevice_content">
Si utilizas la función <code>header</code> para enviar los encabezados <span lang="en">HTTP</span>, debes escribir tú el código que decide si el usuario se ha autentificado correctamente y se le permite acceder o no. Por tanto, puedes incluir las reglas adicionales que quieras, por ejemplo, darle o no acceso en función del día de la semana.

</div>
</section>
</section>
</form>
<section class="iDevice_solution feedback js-hidden">
<h1>Solución</h1>
<ol>
<li><a href="#answer-16_63">Incorrecto</a><span> (<a href="#sa0b16_60">Retroalimentación</a>)</span></li>
<li><a href="#answer-16_89">Opción correcta</a><span> (<a href="#sa1b16_60">Retroalimentación</a>)</span></li>
</ol>
</section>
</section>
</div>
</div>
</div>
</article>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="111_mecanismos_de_autentificacin_ii.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="2_cookies.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<script type="text/javascript" src="_fpd_js.js"></script></body></html>